#!/bin/bash

for txt in ~/SecLists/Discovery/DNS/*.txt

do
	LIST=$txt
	echo "LIST is: $LIST"

   for domain in "$@"

   do
	URL=$domain
	echo "URL is: $URL"
	mkdir ~/workspace/bugs/$URL
	
	ffuf -u http://$URL -w $LIST -H "Host: FUZZ.$URL" -o ~/workspace/bugs/$URL/$URL.ffuf -fs 145 -mc 200,302 | anew ~/workspace/bugs/$URL/hosts.txt
	ffuf -u http://$URL/FUZZ -w $LIST -o ~/workspace/bugs/$URL/$URL.ffuf.subs -mc 200,302 | anew ~/workspace/bugs/$URL/subs.txt


	cat ~/workspace/bugs/$URL/hosts.txt | jq -c '.results[] | {host:.host,status: .status}' | anew $URL.ffuf.txt
	
  done
done
